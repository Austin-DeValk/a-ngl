<html>
  <head>
    <title>A-Frame Super Hands Component - 6DOF With Physics</title>
    <!-- Replace "../build.js" with the super-hands and
         A-Frame distributions to run : 
    <script src="../build.js"></script>-->
    <script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>
    <script src="https://unpkg.com/super-hands/dist/super-hands.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v3.1.2/dist/aframe-physics-system.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@^4.1.1/dist/aframe-event-set-component.min.js"></script>
    <script src="https://unpkg.com/aframe-physics-extras/dist/aframe-physics-extras.min.js"></script>
    <script src="https://rawgit.com/feiss/aframe-environment-component/master/dist/aframe-environment-component.min.js"></script>
    <!-- NGL -->
    <script src="./a-ngl.js"></script>
    <script src="./ngl-dev.js"></script>
    <script>
      //color randomizer
      AFRAME.registerComponent('color-randomizer', {
        play: function () {
          this.el.addEventListener('drag-drop', function (evt) {
            evt.detail.dropped.setAttribute('material', 'color',
              '#'+(Math.random()*0xFFFFFF<<0).toString(16))
            // color randomizer credit: http://stackoverflow.com/questions/1484506/random-color-generator-in-javascript#comment6801353_5365036
          })
        }
      })
      // turn controller's physics presence on only while button held down
      AFRAME.registerComponent('phase-shift', {
        init: function () {
          var el = this.el
          el.addEventListener('gripdown', function () {
            el.setAttribute('collision-filter', {collisionForces: true})
          })
          el.addEventListener('gripup', function () {
            el.setAttribute('collision-filter', {collisionForces: false})
          })
        }
      })
    </script>
  </head>
  <body>
    <a-scene physics>
      <a-assets>
        <a-mixin id="cube" geometry="primitive: box; width: 0.33; height: 0.33; depth: 0.33"
                 hoverable grabbable stretchable draggable
                 event-set__hoveron="_event: hover-start; material.opacity: 0.7; transparent: true"
                 event-set__hoveroff="_event: hover-end; material.opacity: 1; transparent: false"
                 dynamic-body shadow></a-mixin>
        <a-mixin id="transformer" color-randomizer droppable static-body
                 collision-filter="collisionForces: false"
                 event-set__dragon="_event: dragover-start; material.wireframe: true"
                 event-set__dragoff="_event: dragover-end; material.wireframe: false"
                 geometry="primitive: box; width: 0.5; height: 0.5; depth: 0.5"></a-mixin>
        <a-mixin id="touch"
                 physics-collider phase-shift
                 collision-filter="collisionForces: false"
                 static-body="shape: sphere; sphereRadius: 0.02"
                 super-hands="colliderEvent: collisions;
                              colliderEventProperty: els;
                              colliderEndEvent: collisions;
                              colliderEndEventProperty: clearedEls;">
        </a-mixin>
      </a-assets>
      <a-entity>
        <a-camera positon="0 1.6 0"></a-camera>
        <a-entity id="rhand" mixin="touch"
                  vive-controls="hand: right"
                  oculus-touch-controls="hand: right"
                  windows-motion-controls="hand: right">
        </a-entity>
        <a-entity id="lhand" mixin="touch"
                  vive-controls="hand: left"
                  oculus-touch-controls="hand: left"
                  windows-motion-controls="hand: left">
        </a-entity>
      </a-entity>
      
      <!-- Ground static body -->
      <a-box static-body width="100" height="1" depth="100" visible="true" color="grey" position="0 .5 0"></a-box>

      <!-- Molecules -->
      <a-box dynamic-body
             rotation="0 0 0" position="0 5 -.6" depth="0.2" width="0.2" height="0.2"
             hoverable grabbable stretchable draggable droppable
             wireframe="false" color="blue">
          <!-- 
          <a-entity ngl-mol="src: rcsb://1crn;
                             repAlgebra: protein=cartoon=bfactor; 
                             wrapperOpacity: 0.2"
                    position="0 0 0" scale="0.006 0.006 0.006"></a-entity>-->
      </a-box>
      
    </a-scene>
  </body>
</html>